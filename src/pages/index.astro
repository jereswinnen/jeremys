---
import MasterLayout from "../layouts/MasterLayout.astro";
import ProjectImageScroll from "../components/ProjectImageScroll.astro";
import ProjectItem from "../components/ProjectItem.astro";
import SectionHeader from "../components/SectionHeader";
import { ListNumbers } from "phosphor-react";
import { getCollection } from "astro:content";
import type { ImageLayout } from "../types/project";

const work = await getCollection("work");

type ProjectName =
  | "gamepal"
  | "realo"
  | "yally"
  | "helpper"
  | "scorecard"
  | "shelf"
  | "immo brown"
  | "diabetik";

type ProjectLayouts = {
  [K in ProjectName]?: ImageLayout[];
};

const projectImageLayouts: ProjectLayouts = {
  gamepal: [
    { index: 0, span: 12, spanSm: 6 },
    { index: 1, span: 4, start: 8 },
    { index: 2, span: 4 },
    { index: 3, span: 6, start: 7 },
    { index: 4, span: 12 },
  ],
  realo: [
    { index: 0, span: 12 },
    { index: 1, span: 6 },
    { index: 2, span: 6, start: 7 },
    { index: 3, span: 4 },
    { index: 4, span: 4, start: 5 },
    { index: 5, span: 4, start: 9 },
  ],
  yally: [
    { index: 0, span: 12 },
    { index: 1, span: 6 },
    { index: 2, span: 6, start: 7 },
    { index: 3, span: 4 },
  ],
  helpper: [
    { index: 0, span: 12 },
    { index: 1, span: 6 },
    { index: 2, span: 6, start: 7 },
    { index: 3, span: 4 },
  ],
  scorecard: [
    { index: 0, span: 12 },
    { index: 1, span: 6 },
    { index: 2, span: 6, start: 7 },
    { index: 3, span: 4 },
  ],
  shelf: [
    { index: 0, span: 12 },
    { index: 1, span: 6 },
    { index: 2, span: 6, start: 7 },
  ],
  diabetik: [
    { index: 0, span: 12 },
    { index: 1, span: 6 },
    { index: 2, span: 6, start: 7 },
    { index: 3, span: 4 },
  ],
  "immo brown": [
    { index: 0, span: 12 },
    { index: 1, span: 6 },
    { index: 2, span: 6, start: 7 },
    { index: 3, span: 4 },
  ],
};

const projectOrder: ProjectName[] = [
  "gamepal",
  "yally",
  "helpper",
  "scorecard",
  "realo",
  "shelf",
  "immo brown",
  "diabetik",
];

const sortedWork = work.sort((a: any, b: any) => {
  const orderA = projectOrder.indexOf(a.data.name.toLowerCase() as ProjectName);
  const orderB = projectOrder.indexOf(b.data.name.toLowerCase() as ProjectName);
  return orderA - orderB;
});

function getProjectLayoutKey(name: string): ProjectName {
  const key = name.toLowerCase() as ProjectName;
  return key;
}
---

<MasterLayout>
  <ProjectImageScroll class="o-grid-bleed col-span-full" work={work} />

  <article class="hidden col-start-2 col-end-7">
    <h1>This is some text for the homepage</h1>
  </article>

  <SectionHeader icon={ListNumbers} text="Selected work" />

  {
    sortedWork.map((project: any) => (
      <ProjectItem
        class="o-grid-inner col-span-full"
        project={project}
        imageLayout={
          projectImageLayouts[getProjectLayoutKey(project.data.name)]
        }
      />
    ))
  }
</MasterLayout>
